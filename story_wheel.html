<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Story Starter Wheel</title>
    <style>
        /* --- GENERAL STYLES --- */
        * { box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background-color: #ffffff;
            margin: 0;
            height: 100vh;
            display: flex;
            overflow: hidden;
        }

        /* --- SIDEBAR (SCENE REFERENCE) --- */
        .sidebar {
            width: 35%;
            background-color: #f9f9f9;
            border-right: 2px solid #ddd;
            padding: 20px;
            overflow-y: auto;
            box-shadow: inset -5px 0 10px -5px rgba(0,0,0,0.1);
        }
        .sidebar h2 { color: #333; margin-top: 0; border-bottom: 2px solid #0056b3; padding-bottom: 10px;}
        .sidebar p.instructions { color: #666; font-style: italic; font-size: 14px;}

        .scene-card {
            background: #fff;
            border-left: 5px solid #0056b3; /* Matches Outer Ring */
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .scene-title { font-weight: bold; font-size: 16px; color: #0056b3; margin-bottom: 8px; }
        .scene-text { font-size: 13px; color: #444; line-height: 1.4; font-style: italic;}

        /* --- MAIN AREA & WHEEL STYLES --- */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: #ffffff;
        }

        .wheel-container {
            position: relative;
            width: 600px;
            height: 600px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* RINGS */
        .ring {
            position: absolute;
            border-radius: 50%;
            border: 4px solid #fff;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.15s ease-out; /* Smooth tracking */
            cursor: grab;
        }
        .ring:active { cursor: grabbing; }

        /* Outer Ring - Blue - 8 items */
        #outer-ring { width: 580px; height: 580px; background-color: #0056b3; z-index: 1; }
        /* Inner Ring - Red - 6 items */
        #inner-ring { width: 380px; height: 380px; background-color: #d9534f; z-index: 2; }

        /* TEXT ON RINGS */
        .ring-spoke {
            position: absolute; height: 50%; top: 0; left: 50%; width: 0;
            transform-origin: bottom center; pointer-events: none;
        }

        .text-label {
            position: absolute; top: 15px; left: -75px; width: 150px;
            text-align: center; color: white; font-weight: bold;
            font-size: 15px; text-transform: uppercase;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
        }

        /* CENTER CIRCLE (RESULTS) */
        #center-circle {
            position: absolute; width: 220px; height: 220px;
            background-color: white; border-radius: 50%; z-index: 3;
            border: 6px solid #333;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center; padding: 10px;
            pointer-events: none;
        }
        .arrow {
            position: absolute; top: -10px; z-index: 10;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-top: 40px solid #333;
        }

        #result-title { font-size: 24px; font-weight: 900; margin: 0 0 10px 0; color: #d9534f; }
        #result-desc { font-size: 13px; color: #333; line-height: 1.5; font-weight: bold;}
        .starter-option { display: block; margin-bottom: 4px; font-style: italic; color: #555;}

        /* CONTROLS */
        .controls-area { margin-top: 20px; display: flex; gap: 30px; }
        .control-group { text-align: center; background: #f0f0f0; padding: 15px; border-radius: 8px; }
        button {
            padding: 10px 20px; font-size: 18px; cursor: pointer;
            background-color: #fff; border: 2px solid #ccc; border-radius: 6px; margin: 0 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button:hover { background-color: #e9e9e9; }
        .lbl { font-size: 14px; font-weight: bold; margin-bottom: 8px; display: block; color: #333; text-transform: uppercase;}
        .lbl.blue { color: #0056b3; }
        .lbl.red { color: #d9534f; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h2>Scene Reference Menu</h2>
        <p class="instructions">Read the scenes below. Use the outer blue wheel to select the scene number you want to build.</p>

        <div class="scene-card">
            <div class="scene-title">SCENE 1: Thriller (Ledge)</div>
            <div class="scene-text">A narrow ledge... Someone moves gingerly, back against the wall, eyes trying not to look down, feet feeling for the next step...</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 2: Western (Saloon)</div>
            <div class="scene-text">A western saloon. Piano tinkling. Cowhands drinking. A stranger appears at the swing door...</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 3: Horror (Bedroom)</div>
            <div class="scene-text">A bedroom at night, full moon. A young girl sleeping. A figure appears beside her bed, leans over...</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 4: Sports (Penalty)</div>
            <div class="scene-text">A penalty shootout. Final kick. The player places the ball. Looks at the keeper. Begins his run...</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 5: Mystery (Manor)</div>
            <div class="scene-text">Night. An old country house. A figure climbs ivy to a balcony. Flash of a blade, window prised open, they climb inside...</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 6: Crime (Airport)</div>
            <div class="scene-text">Airport lockers. A man approaches furtively, opens a locker, removes a briefcase. From behind, a gun pressed into his ribs...</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 7: Action (Wire)</div>
            <div class="scene-text">Night. A figure crawls to a barbed wire fence. Whistles softly. Joined by a second figure. They begin to cut the wire.</div>
        </div>
        <div class="scene-card">
            <div class="scene-title">SCENE 8: Drama (School)</div>
            <div class="scene-text">School yard at night. Caretaker doing rounds. Shadowy figures dodge and hide. They approach a window and prise it open...</div>
        </div>
    </div>

    <div class="main-content">
        <div class="wheel-container">
            <div class="arrow"></div>

            <div id="outer-ring" class="ring">
                </div>

            <div id="inner-ring" class="ring">
                 </div>

            <div id="center-circle">
                <h1 id="result-title">...</h1>
                <div id="result-desc">Spin to plan!</div>
            </div>
        </div>

        <div class="controls-area">
            <div class="control-group">
                <span class="lbl blue">Outer Ring (Select Scene)</span>
                <button onclick="rotateRing('outer-ring', -45)">◀</button>
                <button onclick="rotateRing('outer-ring', 45)">▶</button>
            </div>
            <div class="control-group">
                <span class="lbl red">Inner Ring (Planning Question)</span>
                <button onclick="rotateRing('inner-ring', -60)">◀</button>
                <button onclick="rotateRing('inner-ring', 60)">▶</button>
            </div>
        </div>
    </div>

    <script>
        // --- DATA CONFIGURATION ---

        // 1. The Scenes (Outer Ring Data)
        // Group A = Stealth/Quiet/Tension (1, 5, 7, 8)
        // Group B = Confrontation/Meeting (2, 6)
        // Group C = High Stakes Moment (3, 4)
        var scenesData = [
            { label: "SCENE 1 (Thriller)", group: 'A' },
            { label: "SCENE 2 (Western)", group: 'B' },
            { label: "SCENE 3 (Horror)", group: 'C' },
            { label: "SCENE 4 (Sports)", group: 'C' },
            { label: "SCENE 5 (Mystery)", group: 'A' },
            { label: "SCENE 6 (Crime)", group: 'B' },
            { label: "SCENE 7 (Action)", group: 'A' },
            { label: "SCENE 8 (Drama)", group: 'A' }
        ];

        // 2. The Questions (Inner Ring Data)
        var questionsData = [
            { label: "WHO?", full: "Who is the main character here? Give them a name." },
            { label: "WHY?", full: "What is their immediate goal right now?" },
            { label: "WHAT NEXT?", full: "What happens immediately after the prompt ends?" },
            { label: "SIGHT / SOUND", full: "Zoom in: Describe one specific sight and sound." },
            { label: "TOUCH / FEEL", full: "Zoom in: Describe a physical sensation." },
            { label: "EMOTION", full: "How are they feeling inside? (e.g., heart rate)." }
        ];

        // 3. Sentence Starters tailored by Scene Group
        var starterPrompts = {
            'A': [ // Stealth/Quiet
                "Suddenly, a loud crack echoed through the air when...",
                "He held his breath as the sound of...",
                "His heart hammered against his ribs like a drum because..."
            ],
            'B': [ // Confrontation
                "The stranger’s voice was low and gravelly as he said...",
                "She froze, realizing there was no way out...",
                "Without thinking, he spun around and..."
            ],
            'C': [ // High Stakes
                "Time seemed to slow down as...",
                "A cold shiver ran down her spine when...",
                "The world went silent around them as..."
            ]
        };


        // --- WHEEL SETUP FUNCTIONS ---

        function setupRing(ringId, dataArray) {
            var ring = document.getElementById(ringId);
            var count = dataArray.length;
            var angleStep = 360 / count;

            for (var i = 0; i < count; i++) {
                var spoke = document.createElement('div');
                spoke.className = 'ring-spoke';
                // Center the spoke in the segment
                var rotation = (i * angleStep) + (angleStep / 2);
                spoke.style.transform = 'rotate(' + rotation + 'deg)';

                var label = document.createElement('div');
                label.className = 'text-label';
                // Just use the short label for the wheel text
                label.innerText = dataArray[i].label;

                spoke.appendChild(label);
                ring.appendChild(spoke);
            }
        }

        // Initialize Rings
        setupRing('outer-ring', scenesData);
        setupRing('inner-ring', questionsData);


        // --- INTERACTION LOGIC ---

        var rotations = { 'outer-ring': 0, 'inner-ring': 0 };

        // Button click handler
        function rotateRing(id, deg) {
            rotations[id] += deg;
            document.getElementById(id).style.transform = 'rotate(' + rotations[id] + 'deg)';
            updateCenter();
        }

        // Drag logic variables
        var activeRing = null; var startAngle = 0;
        var container = document.querySelector('.wheel-container');

        // Calculate angle for drag rotation
        function getMouseAngle(e) {
            var rect = container.getBoundingClientRect();
            var clientX = e.clientX || (e.touches ? e.touches[0].clientX : 0);
            var clientY = e.clientY || (e.touches ? e.touches[0].clientY : 0);
            var centerX = rect.left + rect.width / 2;
            var centerY = rect.top + rect.height / 2;
            // Calculate angle relative to center, convert to degrees, adjust orientation
            return Math.atan2(clientY - centerY, clientX - centerX) * (180 / Math.PI) + 90;
        }

        // Drag Event Listeners
        window.addEventListener('mousedown', startDrag); window.addEventListener('touchstart', startDrag, { passive: false });
        window.addEventListener('mousemove', moveDrag); window.addEventListener('touchmove', moveDrag, { passive: false });
        window.addEventListener('mouseup', stopDrag); window.addEventListener('touchend', stopDrag);

        function startDrag(e) {
            if (e.target.id === 'outer-ring' || e.target.id === 'inner-ring') {
                e.preventDefault();
                activeRing = e.target;
                // Calculate initial offset between mouse angle and current ring rotation
                startAngle = getMouseAngle(e) - rotations[activeRing.id];
            }
        }

        function moveDrag(e) {
            if (!activeRing) return;
            e.preventDefault();
            var currentMouseAngle = getMouseAngle(e);
            // Apply the offset to get the new rotation
            rotations[activeRing.id] = currentMouseAngle - startAngle;
            activeRing.style.transform = 'rotate(' + rotations[activeRing.id] + 'deg)';
            updateCenter();
        }

        function stopDrag() { activeRing = null; }


        // --- CORE LOGIC: UPDATE CENTER CIRCLE ---

        function updateCenter() {
            // Get indices of top items
            var sceneIndex = getIndex(rotations['outer-ring'], scenesData.length);
            var questionIndex = getIndex(rotations['inner-ring'], questionsData.length);

            // Get active data objects
            var activeScene = scenesData[sceneIndex];
            var activeQuestion = questionsData[questionIndex];

            // Update Center Title (The Question)
            document.getElementById('result-title').innerText = activeQuestion.label;

            // Update Center Body (Full Question + Starters based on scene group)
            var descHtml = "<strong>" + activeQuestion.full + "</strong><br/><br/>";
            descHtml += "<em>Starters for this scene type:</em><br/>";

            // Get the relevant starters based on the Scene Group (A, B, or C)
            var relevantStarters = starterPrompts[activeScene.group];
            // Add them to the HTML
            for (var i = 0; i < relevantStarters.length; i++) {
                 descHtml += '<span class="starter-option">“' + relevantStarters[i] + '”</span>';
            }

            document.getElementById('result-desc').innerHTML = descHtml;
        }

        // Helper to calculate index based on rotation angle at the top (0deg)
        function getIndex(rotation, total) {
            var step = 360 / total;
            // Normalize rotation to positive 0-360
            var angle = rotation % 360;
            if (angle < 0) angle += 360;
            // Invert angle because clockwise rotation increases angle, but moves index backward relative to top
            var index = Math.floor(((360 - angle) % 360) / step);
            return index;
        }

        // Initialize center
        updateCenter();
    </script>
</body>
</html>
